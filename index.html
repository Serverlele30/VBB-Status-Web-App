<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>VBB Netz Status</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="images/favicon.png">
    <link rel="apple-touch-icon" href="images/favicon.png">
    <link rel="stylesheet" href="styles.css">
</head>
    
    <!-- Leaflet CSS fÃ¼r Live-Map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
          crossorigin=""/>
    
    <!-- Leaflet JS fÃ¼r Live-Map -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" 
            crossorigin=""></script>
</head>
<body>
    <div class="offline-indicator" id="offlineIndicator">
        ğŸ“µ Offline-Modus - Zeige gespeicherte Daten
    </div>

    <div class="ptr-container" id="ptrContainer">
        <div class="ptr-spinner"></div>
    </div>

    <div class="header">
        <div class="header-content">
            <div class="header-title">
                <h1>VBB NETZ STATUS</h1>
                <div class="subtitle">Live-Nahverkehr fÃ¼r Berlin & Brandenburg</div>
                <div class="author">by Aaron K. & Claude (Anthropic)</div>
            </div>
            <button class="menu-btn" id="menuBtn" aria-label="MenÃ¼ Ã¶ffnen">
                â˜°
            </button>
        </div>
    </div>

    <!-- Navigation Menu -->
    <div class="nav-menu" id="navMenu">
        <div class="nav-header">
            <h3>Funktionen</h3>
            <button class="nav-close" id="navClose">Ã—</button>
        </div>
        <div class="nav-items">
            <button class="nav-item" data-view="home">
                <span class="nav-icon">ğŸ </span>
                <span class="nav-label">Start</span>
            </button>
            <button class="nav-item" data-view="departures">
                <span class="nav-icon">ğŸš‡</span>
                <span class="nav-label">Abfahrten</span>
            </button>
            <button class="nav-item" data-view="journey">
                <span class="nav-icon">ğŸ—ºï¸</span>
                <span class="nav-label">Routenplaner</span>
            </button>
            <button class="nav-item" data-view="livemap">
                <span class="nav-icon">ğŸŒ</span>
                <span class="nav-label">Live-Map</span>
            </button>
            <button class="nav-item" data-view="developer">
                <span class="nav-icon">ğŸ‘¨â€ğŸ’»</span>
                <span class="nav-label">FÃ¼r Entwickler</span>
            </button>
        </div>
    </div>
    <div class="nav-overlay" id="navOverlay"></div>

    <!-- View: Home -->
    <div class="view-container active" id="view-home">
        <div class="home-container">
            
            <!-- Combined Hero + Navigation Box -->
            <div class="home-hero-combined">
                <!-- Navigation Hint OHNE Pfeil -->
                <div class="home-nav-hint">
                    <div class="home-hint-text">
                        Tippe <strong>oben rechts auf "â‰¡"</strong> um das MenÃ¼ zu Ã¶ffnen.<br>
                        WÃ¤hle dann <strong>Abfahrten</strong>, <strong>Routenplaner</strong> oder <strong>Live-Map</strong>.
                    </div>
                </div>

                <!-- Hero Section -->
                <div class="home-hero-title">
                    <h1>VBB NETZ STATUS</h1>
                    <p>Live-Nahverkehr fÃ¼r Berlin & Brandenburg</p>
                    <div class="home-version">v31.0</div>
                </div>
            </div>

            <!-- Quick Info Cards -->
            <div class="home-quick-info">
                <div class="home-info-card">
                    <div class="home-info-icon">ğŸš‡</div>
                    <div class="home-info-text">
                        <strong>Live-Abfahrten</strong>
                        <p>Echtzeit fÃ¼r alle VBB-Stationen</p>
                    </div>
                </div>
                <div class="home-info-card">
                    <div class="home-info-icon">ğŸ—ºï¸</div>
                    <div class="home-info-text">
                        <strong>Routenplaner</strong>
                        <p>Schnellste Verbindungen finden</p>
                    </div>
                </div>
                <div class="home-info-card">
                    <div class="home-info-icon">ğŸŒ</div>
                    <div class="home-info-text">
                        <strong>Live-Map</strong>
                        <p>Fahrzeuge in Echtzeit verfolgen</p>
                    </div>
                </div>
            </div>


            <!-- Footer -->
            <div class="home-footer">
                <p><strong>Inoffizielle App</strong> â€“ Nicht von VBB/BVG betrieben</p>
                <p class="home-footer-small">Made with â¤ï¸ for Berlin & Brandenburg</p>
                <p class="home-footer-github">
                    <a href="https://github.com/Serverlele30/VBB-Status-Web-App" target="_blank">
                        â­ Star on GitHub
                    </a>
                </p>
            </div>
        </div>
    </div>

    <!-- View: Abfahrten -->
    <div class="view-container" id="view-departures">
        <div class="container">
            <div class="controls">
                <div class="search-row">
                    <div class="search-container">
                        <input 
                            type="text" 
                            id="stationSearch" 
                            class="search-input" 
                            placeholder="Station suchen..."
                            autocomplete="off"
                        >
                        <button class="clear-btn" id="clearBtn">Ã—</button>
                        <div class="suggestions" id="suggestions"></div>
                    </div>
                    <button class="location-btn-side" id="locationBtn" title="NÃ¤chste Station per GPS finden">
                        ğŸ“
                    </button>
                </div>
                <div class="button-group">
                    <button class="btn" id="refreshBtn" disabled>ğŸ”„ Aktualisieren</button>
                </div>
                
                <!-- Filter fÃ¼r Linientypen -->
                <div class="departure-filters" id="departureFilters" style="display: none;">
                    <div class="filter-label">Filter:</div>
                    <button class="filter-btn active" data-filter="all">Alle</button>
                    <button class="filter-btn" data-filter="subway">ğŸš‡ U-Bahn</button>
                    <button class="filter-btn" data-filter="suburban">ğŸš† S-Bahn</button>
                    <button class="filter-btn" data-filter="tram">ğŸšŠ Tram</button>
                    <button class="filter-btn" data-filter="bus">ğŸšŒ Bus</button>
                    <button class="filter-btn" data-filter="regional">ğŸš„ Regional</button>
                </div>
            </div>

            <div id="departuresContainer" class="departures-container"></div>
        </div>
    </div>

    <!-- View: Routenplaner -->
    <div class="view-container" id="view-journey">
        <div class="container">
            <div class="controls">
                <div class="journey-inputs">
                    <div class="journey-input-group">
                        <label class="journey-label">ğŸ”µ Von</label>
                        <div class="search-row">
                            <div class="search-container">
                                <input 
                                    type="text" 
                                    id="journeyFrom" 
                                    class="search-input" 
                                    placeholder="Startstation..."
                                    autocomplete="off"
                                >
                                <button class="clear-btn" id="clearFromBtn">Ã—</button>
                                <div class="suggestions" id="suggestionsFrom"></div>
                            </div>
                            <button class="location-btn-side" id="locationFromBtn" title="Aktuellen Standort nutzen">
                                ğŸ“
                            </button>
                        </div>
                    </div>

                    <button class="swap-btn" id="swapBtn" title="Start und Ziel tauschen">
                        â‡…
                    </button>

                    <div class="journey-input-group">
                        <label class="journey-label">ğŸ”´ Nach</label>
                        <div class="search-row">
                            <div class="search-container">
                                <input 
                                    type="text" 
                                    id="journeyTo" 
                                    class="search-input" 
                                    placeholder="Zielstation..."
                                    autocomplete="off"
                                >
                                <button class="clear-btn" id="clearToBtn">Ã—</button>
                                <div class="suggestions" id="suggestionsTo"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <div style="font-size: 12px; opacity: 0.7; text-align: center; margin-bottom: 10px; color: #FFED00;">
                        Garantiert mind. 5 Min Umstiegszeit
                    </div>
                    <button class="btn btn-full-width" id="searchJourneyBtn" disabled>ğŸ” Route suchen</button>
                </div>
                
                <!-- Verkehrsmittel-Filter -->
                <div class="journey-transport-filters">
                    <div class="filter-label">Verkehrsmittel:</div>
                    <button class="transport-filter-btn active" data-transport="subway">ğŸš‡ U-Bahn</button>
                    <button class="transport-filter-btn active" data-transport="suburban">ğŸš† S-Bahn</button>
                    <button class="transport-filter-btn active" data-transport="tram">ğŸšŠ Tram</button>
                    <button class="transport-filter-btn active" data-transport="bus">ğŸšŒ Bus</button>
                    <button class="transport-filter-btn active" data-transport="regional">ğŸš„ Regional</button>
                    <button class="transport-filter-btn active" data-transport="express">ğŸš… Express</button>
                </div>
            </div>

            <div id="journeyContainer" class="journey-container"></div>
        </div>
    </div>

    <!-- View: Live-Map -->
    <div class="view-container" id="view-livemap">
        <div class="livemap-container">
            <div class="livemap-controls">
                <div class="livemap-info">
                    <span id="vehicleCount">ğŸš‡ Lade Fahrzeuge...</span>
                </div>
                <div class="livemap-filters">
                    <button class="filter-btn active" data-type="all">ğŸŒ Alle</button>
                    <button class="filter-btn" data-type="subway">ğŸš‡ U-Bahn</button>
                    <button class="filter-btn" data-type="suburban">ğŸš† S-Bahn</button>
                    <button class="filter-btn" data-type="tram">ğŸšŠ Tram</button>
                    <button class="filter-btn" data-type="bus">ğŸšŒ Bus</button>
                </div>
            </div>
            <div id="liveMap"></div>
        </div>
    </div>

    <!-- View: FÃ¼r Entwickler -->
    <div class="view-container" id="view-developer">
        <div class="container">
            <div class="developer-header">
                <h2>ğŸ‘¨â€ğŸ’» FÃ¼r Entwickler</h2>
                <p class="developer-subtitle">Technische Details, Changelog & Funktionen</p>
            </div>
            
            <!-- Developer Tabs -->
            <div class="developer-tabs">
                <button class="dev-tab active" data-tab="changelog">ğŸ“‹ Changelog</button>
                <button class="dev-tab" data-tab="info">â„¹ï¸ Info</button>
                <button class="dev-tab" data-tab="features">âœ¨ Features</button>
            </div>

            <!-- Tab: Changelog -->
            <div class="dev-tab-content active" id="dev-changelog">
                <div id="changelogContent" class="changelog-container">
                    <div class="loading-detail">â³ Lade Changelog...</div>
                </div>
            </div>

            <!-- Tab: Info -->
            <div class="dev-tab-content" id="dev-info">
                <div class="dev-info-container">
                    <div class="dev-info-box">
                        <h3>ğŸš€ Version Info</h3>
                        <table class="dev-info-table">
                            <tr><td>Version:</td><td><strong>30.0</strong></td></tr>
                            <tr><td>Release:</td><td>10.02.2026</td></tr>
                            <tr><td>Lizenz:</td><td>MIT</td></tr>
                            <tr><td>Status:</td><td><span class="status-badge-dev">âœ… Stabil</span></td></tr>
                        </table>
                    </div>

                    <div class="dev-info-box">
                        <h3>ğŸ“¦ Dependencies</h3>
                        <table class="dev-info-table">
                            <tr><td>Node.js:</td><td>â‰¥ 16.0.0</td></tr>
                            <tr><td>npm:</td><td>â‰¥ 8.0.0</td></tr>
                            <tr><td>mime-types:</td><td>^2.1.35</td></tr>
                        </table>
                    </div>

                    <div class="dev-info-box">
                        <h3>ğŸ› ï¸ Tech Stack</h3>
                        <table class="dev-info-table">
                            <tr><td>Frontend:</td><td>Vanilla JS, CSS3, HTML5</td></tr>
                            <tr><td>Maps:</td><td>Leaflet.js</td></tr>
                            <tr><td>API:</td><td>VBB Transport REST v6</td></tr>
                            <tr><td>PWA:</td><td>Service Worker, Manifest</td></tr>
                            <tr><td>Server:</td><td>Node.js HTTPS</td></tr>
                        </table>
                    </div>

                    <div class="dev-info-box">
                        <h3>ğŸ“Š Statistiken</h3>
                        <table class="dev-info-table">
                            <tr><td>HTML:</td><td>407 Zeilen</td></tr>
                            <tr><td>CSS:</td><td>2689 Zeilen</td></tr>
                            <tr><td>JavaScript:</td><td>2161 Zeilen</td></tr>
                            <tr><td>Gesamt:</td><td>~5.300 Zeilen Code</td></tr>
                        </table>
                    </div>

                    <a href="https://github.com/Serverlele30/VBB-Status-Web-App" 
                       target="_blank" 
                       class="github-link-btn">
                        ğŸ’» Code auf GitHub ansehen
                    </a>
                </div>
            </div>

            <!-- Tab: Features Detail -->
            <div class="dev-tab-content" id="dev-features">
                <div class="dev-features-container">
                    <details class="feature-detail" open>
                        <summary>ğŸš‡ Abfahrten-Monitor</summary>
                        <div class="feature-content">
                            <p><strong>Echtzeit-Abfahrten fÃ¼r alle VBB-Stationen</strong></p>
                            <ul>
                                <li>GPS-Standortsuche (nur Mobile)</li>
                                <li>Manuelle Stationssuche</li>
                                <li>Auto-Refresh alle 30s</li>
                                <li>VerspÃ¤tungsanzeige</li>
                                <li>Linien-Filter</li>
                                <li>Detail-Ansicht mit Zwischenhalten</li>
                            </ul>
                            <p class="feature-api"><strong>API:</strong> <code>GET /stops/:id/departures</code></p>
                        </div>
                    </details>

                    <details class="feature-detail">
                        <summary>ğŸ—ºï¸ Routenplaner</summary>
                        <div class="feature-content">
                            <p><strong>Intelligente Routenplanung im VBB-Netz</strong></p>
                            <ul>
                                <li>Von/Nach Suche mit Autocomplete</li>
                                <li>GPS-Standort als Start/Ziel (nur Mobile)</li>
                                <li>Mehrere Routenoptionen</li>
                                <li>Umstiegsanzeige mit Zeiten</li>
                                <li>Verkehrsmittel-Filter</li>
                                <li>Detail-Ansicht mit allen Haltestellen</li>
                            </ul>
                            <p class="feature-api"><strong>API:</strong> <code>GET /journeys</code></p>
                        </div>
                    </details>

                    <details class="feature-detail">
                        <summary>ğŸŒ Live-Map</summary>
                        <div class="feature-content">
                            <p><strong>Echtzeit-Fahrzeugverfolgung</strong></p>
                            <ul>
                                <li>Leaflet.js Kartenintegration</li>
                                <li>Dynamische Bounding Box</li>
                                <li>Fahrzeug-Filter (U-Bahn, S-Bahn, Bus, Tram)</li>
                                <li>BVG-Linienfarben</li>
                                <li>Auto-Update alle 15s</li>
                                <li>Zoom & Pan optimiert</li>
                            </ul>
                            <p class="feature-api"><strong>API:</strong> <code>GET /radar</code></p>
                        </div>
                    </details>

                    <details class="feature-detail">
                        <summary>ğŸ“± Progressive Web App</summary>
                        <div class="feature-content">
                            <p><strong>Moderne PWA-Funktionen</strong></p>
                            <ul>
                                <li>Installierbar (Add to Home Screen)</li>
                                <li>Service Worker mit Caching</li>
                                <li>Offline-Modus</li>
                                <li>Push-Benachrichtigungen (geplant)</li>
                                <li>App-Manifest</li>
                            </ul>
                            <p class="feature-api"><strong>Cache:</strong> <code>vbb-status-v30</code></p>
                        </div>
                    </details>

                    <details class="feature-detail">
                        <summary>ğŸ¨ UI/UX Features</summary>
                        <div class="feature-content">
                            <p><strong>Design & Benutzerfreundlichkeit</strong></p>
                            <ul>
                                <li>Dark Mode (Standard)</li>
                                <li>Responsive Design (Mobile â†’ Desktop)</li>
                                <li>DotMatrix Retro-Font</li>
                                <li>Touch-optimiert</li>
                                <li>Hover-Effekte (Desktop)</li>
                                <li>Accessibility (WCAG)</li>
                            </ul>
                        </div>
                    </details>
                </div>
            </div>
        </div>
    </div>

    <!-- Detail Modal -->
    <div class="detail-modal" id="detailModal">
        <div class="detail-header">
            <button class="detail-back-btn" id="detailBackBtn">â†</button>
            <div class="detail-title" id="detailTitle">Fahrzeug-Details</div>
            <div style="width: 34px;"></div>
        </div>
        <div class="detail-content" id="detailContent">
            <div class="loading-detail">â³ Lade Details...</div>
        </div>
    </div>

    <!-- Journey Detail Modal -->
    <div class="detail-modal" id="journeyDetailModal">
        <div class="detail-header">
            <button class="detail-back-btn" id="journeyDetailBackBtn">â†</button>
            <div class="detail-title" id="journeyDetailTitle">Routen-Details</div>
            <div style="width: 34px;"></div>
        </div>
        <div class="detail-content" id="journeyDetailContent">
            <div class="loading-detail">â³ Lade Details...</div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
